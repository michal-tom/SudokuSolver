namespace SudokuSolver.Tests
{
    using Microsoft.VisualStudio.TestTools.UnitTesting;
    using SudokuSolver.Lib;
    using SudokuSolver.Parser;

    [TestClass]
    public class ResolverTests
    {
        [DataTestMethod]
        [DataRow("6..9......3.4.5.1.7.8.1.5..917.6.4......4......4.8.932..5.2.8.6.7.1.4.2......6..1", "651938274239475618748612593917263485382549167564781932195327846876154329423896751")]
        [DataRow("...9......3.4.5.1.7.8.1.5..917.6.4......4......4.8.932..5.2.8.6.7.1.4.2......6..1", "251938674639475218748612593917263485382549167564781932195327846876154329423896751")]
        [DataRow("..17....2.4...2.......5.7.67...6..5..59...46..6..2...89.3.8.......9...8.4....51..", "631748592547692831892351746718469253259813467364527918973184625125976384486235179")]
        [DataRow("...14..2.4.....3....13..7...2..9..3....8.5....8..7..1...8..65....7.....4.6..39...", "356147928472968351891352746125694837743815269689273415918426573237581694564739182")]
        [DataRow(".5.9...2....8.3....2.5..413.64..52..28..4..65..36..17.648..1.3....7.6....3...8.5.", "356914728471823596829567413164375289287149365593682174648251937915736842732498651")]
        [DataRow("9...4.......6...31.2.....9....7...2...29356...7...2....6.....7351...9.......8...9", "931247586754698231628153794195764328482935617376812945869521473513479862247386159")]
        [DataRow("..3..1...8.........51..9.6..8....29....7...8.2...4.5.36..9.......2.84...41..5.6..", "923861457846375921751429368187536294534792186269148573675913842392684715418257639")]
        [DataRow(".32..61..41..........9.1...5...9...4.6.....7.3...2...5...5.8..........19..7...86.", "732456198419283756685971423528197634964835271371624985296518347843762519157349862")]
        [DataRow(".1.9.8..2..6.47.1.5..........7.6..3.6.......5.4..9.2..........4.9.51.7..3..2.4.5.", "714958362286347519539621847957462138621783495843195276175839624492516783368274951")]
        [DataRow("..17....2.4...2.......5.7.67...6..5..59...46..6..2...89.3.8.......9...8.4....51..", "631748592547692831892351746718469253259813467364527918973184625125976384486235179")]
        [DataRow("...4.12...6....3...8...6.4.5.2.3......9...6......7.4.5.2.1...8...6....2...58.2...", "953481267461927358287356941572634819349518672618279435724193586896745123135862794")]
        [DataRow(".4...3.8..3..9....5.74..9......2.....23...56.4...5......6..47.8.5..1..4..9.8...1.", "149763285832591476567482931685327194923148567471659823216934758758216349394875612")]
        [DataRow("13.7..2955.69.......983...1....2........6........7....3...548.......74.6964..1.37", "138746295546912378279835641691428753723569184485173962317654829852397416964281537")]
        [DataRow("6..925....3247.85.4....3.7..1..8.................3..2..9.3....8.24.9153....758..4", "678925413132476859459813672513287946247169385986534721795342168824691537361758294")]
        [DataRow("5.7.84.....8....7....1.........4...2.........9...2.........1....7....2.....35.7.8", "517284369248639571396175824631847952725913486984526137852791643173468295469352718")]
        public void SudokuGridSolvingTest(string inputGridString, string solvedGridString)
        {
            var result = InputParser.ParseGridData(inputGridString);

            Assert.IsTrue(result.IsSuccessfull);
            Assert.IsNotNull(result.Grid);

            var isSolved = GridResolver.TrySolve(result.Grid);

            Assert.IsTrue(isSolved);
            Assert.AreEqual(solvedGridString, result.Grid.ToString());
        }

        [DataTestMethod]
        [DataRow("472369851.63.85.4..584.2.....9.3....23...79..71......3..1..3..732.6.1.8.6...5....")]
        [DataRow("..2369851963185742158472.3684953617.2358179647169.4523581243697327691485694758.1.")]
        public void SudokuUnresolvedGridTest(string inputGridString)
        {
            var result = InputParser.ParseGridData(inputGridString);

            Assert.IsTrue(result.IsSuccessfull);
            Assert.IsNotNull(result.Grid);

            var isSolved = GridResolver.TrySolve(result.Grid);

            Assert.IsFalse(isSolved);
        }
    }
}